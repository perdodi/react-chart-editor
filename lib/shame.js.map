{"version":3,"sources":["../src/shame.js"],"names":["shamefullyClearAxisTypes","graphDiv","traceIndexes","update","Array","isArray","_fullData","hasSrc","key","substr","length","clearAxisTypes","axLetters","gd","traces","i","trace","j","type","ax","axAttr","_name","typeAttr","layout","set","shamefullyAdjustAxisRef","payload","axesToBeGarbageCollected","forEach","a","axis","charAt","axisIdNumber","Number","slice","Object","keys","filter","startsWith","get","subplotToBeGarbageCollected","geoRegex","shamefullyAdjustGeo","k","geoMatch","exec","geo","scope","shamefullyAdjustMapbox","mapbox","style","shamefullyAddTableColumns","data","header","valuessrc","cells","shamefullyAdjustSplitStyleTargetContainers","attr","endsWith","transformIndex","parseInt","split","transform","transforms","styles","dedupedGroups","group","includes","push","map","groupEl","target","value","shamefullyCreateSplitStyleProps","traceIndex","splitTraceGroup","indexOfSplitTransform","t","getProp","indexOfStyleObject","s","toString","path","p","g","shamefullyDeleteRelatedAnalysisTransforms","parentTraceDataIndex","parentUid","uid","relatedAnalysisTraceIndexes","d","some","inputUid","splice","shamefullyAdjustSizeref","size","src","DEFAULT_MAX_AREA_PX","scaleFactor","reduce","b","Math","max","shamefullyAdjustAxisDirection","yaxis","autorange"],"mappings":"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","sourcesContent":["/*\n * DELETE THIS FILE. EVERYTHING NEEDS TO FIND A HOME.\n */\nimport {getFromId} from 'plotly.js/src/plots/cartesian/axis_ids';\nimport nestedProperty from 'plotly.js/src/lib/nested_property';\n\n// Temporary fix for:\n// https://github.com/plotly/react-chart-editor/issues/103\n// We should be able to remove this once the plotly.react method has\n// been integrated into react-plotly.js and released:\n// https://github.com/plotly/react-plotly.js/issues/2\nexport const shamefullyClearAxisTypes = (graphDiv, {traceIndexes, update}) => {\n  if (!Array.isArray(graphDiv._fullData)) {\n    return;\n  }\n  let hasSrc = false;\n  for (const key in update) {\n    if (key.substr(key.length - 3) === 'src') {\n      hasSrc = true;\n    }\n  }\n  if (hasSrc) {\n    clearAxisTypes(graphDiv, traceIndexes);\n  }\n};\n\nconst axLetters = ['x', 'y', 'z'];\nfunction clearAxisTypes(gd, traces) {\n  for (let i = 0; i < traces.length; i++) {\n    const trace = gd._fullData[i];\n    for (let j = 0; j < 3; j++) {\n      const type = axLetters[j];\n      const ax = getFromId(gd, trace[type + 'axis'] || type);\n\n      // Do not clear log type.\n      // Log type is never an auto result so must have been intentional.\n      // We are also skipping clearing 3D which could cause bugs with 3D.\n      if (ax && ax.type !== 'log') {\n        const axAttr = ax._name;\n        const typeAttr = axAttr + '.type';\n        nestedProperty(gd.layout, typeAttr).set(null);\n      }\n    }\n  }\n}\n\nexport const shamefullyAdjustAxisRef = (graphDiv, payload) => {\n  if (payload.axesToBeGarbageCollected) {\n    payload.axesToBeGarbageCollected.forEach(a => {\n      const axis = a.charAt(0);\n      const axisIdNumber = Number(a.slice(1));\n\n      nestedProperty(graphDiv.layout, `${axis}axis${axisIdNumber || ''}`).set(null);\n      Object.keys(graphDiv.layout)\n        .filter(key => key.startsWith(axis + 'axis'))\n        .forEach(key => {\n          if (nestedProperty(graphDiv.layout, `${key}.overlaying`).get() === a) {\n            nestedProperty(graphDiv.layout, `${key}.overlaying`).set(null);\n          }\n        });\n    });\n  }\n  if (payload.subplotToBeGarbageCollected) {\n    nestedProperty(graphDiv.layout, payload.subplotToBeGarbageCollected).set(null);\n  }\n};\n\nconst geoRegex = /^(geo\\d*)\\./;\nexport const shamefullyAdjustGeo = ({layout}, {update}) => {\n  Object.keys(update).forEach(k => {\n    const geoMatch = geoRegex.exec(k);\n    if (geoMatch) {\n      const geo = geoMatch[1];\n      if (update[geo + '.scope']) {\n        update[geo + '.projection'] = {};\n        update[geo + '.center'] = {};\n      }\n\n      if (\n        // requesting projection change\n        update[geo + '.projection.type'] &&\n        (update[geo + '.projection.type'] === 'albers usa' ||\n          (layout[geo] && layout[geo].scope === 'usa'))\n      ) {\n        update[geo + '.scope'] = {};\n        update[geo + '.center'] = {};\n      }\n    }\n  });\n};\n\nexport const shamefullyAdjustMapbox = gd => {\n  if (gd.layout && gd.layout.mapbox && gd.layout.mapbox.style) {\n    return;\n  }\n  nestedProperty(gd.layout, 'mapbox.style').set('open-street-map');\n};\n\nexport const shamefullyAddTableColumns = (graphDiv, {traceIndexes, update}) => {\n  if (\n    update['cells.values'] &&\n    (!graphDiv.data[traceIndexes[0]].header || !graphDiv.data[traceIndexes[0]].header.valuessrc)\n  ) {\n    update['header.values'] = update['cells.valuessrc'];\n  } else if (update['header.values'] === null) {\n    update['header.values'] = graphDiv.data[traceIndexes[0]].cells.valuessrc || null;\n  } else if (update['cells.values'] === null && !graphDiv.data[traceIndexes[0]].header.valuessrc) {\n    update['header.values'] = null;\n  }\n};\n\nexport const shamefullyAdjustSplitStyleTargetContainers = (graphDiv, {traceIndexes, update}) => {\n  for (const attr in update) {\n    if (attr && attr.startsWith('transforms') && attr.endsWith('groups')) {\n      const transformIndex = parseInt(attr.split('[')[1], 10);\n      const transform = graphDiv.data[traceIndexes[0]].transforms[transformIndex];\n\n      if (transform && transform.type === 'groupby' && transform.styles) {\n        // Create style containers for all groups\n        if (!transform.styles.length && update[attr] && Array.isArray(update[attr])) {\n          const dedupedGroups = [];\n          update[attr].forEach(group => {\n            if (!dedupedGroups.includes(group)) {\n              dedupedGroups.push(group);\n            }\n          });\n\n          const styles = dedupedGroups.map(groupEl => ({\n            target: groupEl,\n            value: {},\n          }));\n\n          update[`transforms[${transformIndex}].styles`] = styles;\n        }\n\n        // When clearing the data selector of groupby transforms, we want to clear\n        // all the styles we've added\n        if (transform.styles.length && !update[attr]) {\n          update[`transforms[${transformIndex}].styles`] = [];\n        }\n      }\n    }\n  }\n};\n\nexport const shamefullyCreateSplitStyleProps = (graphDiv, attr, traceIndex, splitTraceGroup) => {\n  if (!Array.isArray(splitTraceGroup)) {\n    splitTraceGroup = [splitTraceGroup]; // eslint-disable-line\n  }\n\n  let indexOfSplitTransform = null;\n\n  graphDiv.data[traceIndex].transforms.forEach((t, i) => {\n    if (t.type === 'groupby') {\n      indexOfSplitTransform = i;\n    }\n  });\n\n  function getProp(group) {\n    let indexOfStyleObject = null;\n\n    graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles.forEach((s, i) => {\n      if (s.target.toString() === group) {\n        indexOfStyleObject = i;\n      }\n    });\n\n    let path =\n      graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles[indexOfStyleObject].value;\n\n    attr.split('.').forEach(p => {\n      if (!path[p]) {\n        path[p] = {};\n      }\n      path = path[p];\n    });\n\n    return nestedProperty(\n      graphDiv.data[traceIndex].transforms[indexOfSplitTransform].styles[indexOfStyleObject].value,\n      attr\n    );\n  }\n\n  return splitTraceGroup.map(g => getProp(g));\n};\n\nexport const shamefullyDeleteRelatedAnalysisTransforms = (graphDiv, payload) => {\n  const parentTraceDataIndex = payload.traceIndexes[0];\n  const parentUid = graphDiv.data[parentTraceDataIndex].uid;\n\n  if (parentUid) {\n    const relatedAnalysisTraceIndexes = [];\n    graphDiv.data.forEach((d, i) => {\n      if (\n        d.transforms &&\n        d.transforms.some(\n          transform =>\n            ['moving-average', 'fit'].includes(transform.type) && transform.inputUid === parentUid\n        )\n      ) {\n        relatedAnalysisTraceIndexes.push(i);\n      }\n    });\n\n    if (relatedAnalysisTraceIndexes.length) {\n      relatedAnalysisTraceIndexes.forEach(i => {\n        graphDiv.data.splice(i, 1);\n      });\n    }\n  }\n};\n\nexport const shamefullyAdjustSizeref = (gd, {update}) => {\n  const {'marker.size': size = null, 'marker.sizesrc': src = null} = update;\n  if (size && src) {\n    const DEFAULT_MAX_AREA_PX = 45;\n    const scaleFactor = DEFAULT_MAX_AREA_PX * DEFAULT_MAX_AREA_PX;\n    update['marker.sizeref'] = size.reduce((a, b) => Math.max(a, b)) / scaleFactor;\n    update['marker.sizemode'] = 'area';\n  }\n};\n\nexport const shamefullyAdjustAxisDirection = (gd, {update}) => {\n  if (update.type === 'funnel' && gd.data.length === 1) {\n    gd.layout.yaxis.autorange = 'reversed';\n  }\n};\n"],"file":"shame.js"}