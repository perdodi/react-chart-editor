{"version":3,"sources":["../../../src/components/fields/ColorArrayPicker.js"],"names":["UnconnectedColorArrayPicker","props","context","fullContainer","rootAttr","attr","split","type","Array","isArray","color","state","value","constant","fullValue","COLORS","mutedBlue","variable","selectedConstantColorOption","multiValued","setType","bind","setValue","setColor","setColorScale","onConstantColorOptionChange","setState","updateContainer","inputValue","updatePlot","colorscale","_","localize","options","label","includes","MULTI_VALUED","Component","propTypes","PropTypes","any","func","Field","contextTypes","displayName"],"mappings":"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","sourcesContent":["import Field from './Field';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {connectToContainer} from 'lib';\nimport RadioBlocks from '../widgets/RadioBlocks';\nimport DataSelector from './DataSelector';\nimport MultiColorPicker from './MultiColorPicker';\nimport {MULTI_VALUED, COLORS} from 'lib/constants';\n\nclass UnconnectedColorArrayPicker extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    const {fullContainer} = props;\n    this.rootAttr = props.attr.split('.')[0];\n\n    let type = null;\n    if (\n      !fullContainer[this.rootAttr] ||\n      (fullContainer[this.rootAttr] && !Array.isArray(fullContainer[this.rootAttr].color))\n    ) {\n      type = 'constant';\n    } else if (fullContainer[this.rootAttr] && Array.isArray(fullContainer[this.rootAttr].color)) {\n      type = 'variable';\n    }\n\n    this.state = {\n      type,\n      value: {\n        constant: type === 'constant' ? props.fullValue : COLORS.mutedBlue,\n        variable: type === 'variable' ? props.fullValue : null,\n      },\n      selectedConstantColorOption: type === 'constant' && props.multiValued ? 'multiple' : 'single',\n    };\n\n    this.setType = this.setType.bind(this);\n    this.setValue = this.setValue.bind(this);\n    this.setColor = this.setColor.bind(this);\n    this.setColorScale = this.setColorScale.bind(this);\n    this.onConstantColorOptionChange = this.onConstantColorOptionChange.bind(this);\n  }\n\n  setType(type) {\n    this.setState({type});\n    this.context.updateContainer(\n      type === 'constant'\n        ? {[this.rootAttr + '.color']: this.state.value[type], [this.rootAttr + '.colorsrc']: null}\n        : {[this.rootAttr + '.color']: this.state.value[type], [this.rootAttr + '.colorsrc']: null}\n    );\n  }\n\n  setValue(inputValue) {\n    const {type} = this.state;\n    this.setState(\n      type === 'constant'\n        ? {value: {constant: inputValue, variable: this.state.value[type]}}\n        : {value: {variable: inputValue, constant: this.state.value[type]}}\n    );\n    this.props.updatePlot(inputValue);\n  }\n\n  setColor(inputValue) {\n    const {type} = this.state;\n\n    this.setState(\n      type === 'constant'\n        ? {value: {constant: inputValue, variable: this.state.value.variable}}\n        : {value: {variable: inputValue, constant: this.state.value.constant}}\n    );\n    this.props.updatePlot(inputValue);\n  }\n\n  setColorScale(inputValue) {\n    this.setState({colorscale: inputValue});\n    this.context.updateContainer({[this.rootAttr + '.colorscale']: inputValue});\n  }\n\n  onConstantColorOptionChange(value) {\n    this.setState({\n      selectedConstantColorOption: value,\n    });\n  }\n\n  render() {\n    const {attr, fullValue} = this.props;\n    const {localize: _} = this.context;\n    const {type} = this.state;\n    const options = [\n      {label: _('Constant'), value: 'constant'},\n      {label: _('Variable'), value: 'variable'},\n    ];\n    const multiValued =\n      this.props.multiValued || (Array.isArray(fullValue) && fullValue.includes(MULTI_VALUED));\n\n    return (\n      <Field {...this.props} multiValued={multiValued} attr={attr}>\n        <RadioBlocks options={options} activeOption={type} onOptionChange={this.setType} />\n        {type === 'constant' ? (\n          <MultiColorPicker\n            attr={this.rootAttr + '.color'}\n            multiColorMessage={_(\n              'Each trace will be colored according to the selected colorscale.'\n            )}\n            singleColorMessage={_('All traces will be colored in the the same color.')}\n            setColor={this.setColor}\n            setColorScale={this.setColorScale}\n            onConstantColorOptionChange={this.onConstantColorOptionChange}\n            parentSelectedConstantColorOption={this.state.selectedConstantColorOption}\n          />\n        ) : multiValued ? null : (\n          <DataSelector\n            suppressMultiValuedMessage\n            attr={this.rootAttr + '.color'}\n            updatePlot={this.setValue}\n          />\n        )}\n      </Field>\n    );\n  }\n}\n\nUnconnectedColorArrayPicker.propTypes = {\n  fullValue: PropTypes.any,\n  updatePlot: PropTypes.func,\n  ...Field.propTypes,\n};\n\nUnconnectedColorArrayPicker.contextTypes = {\n  localize: PropTypes.func,\n  updateContainer: PropTypes.func,\n};\n\nUnconnectedColorArrayPicker.displayName = 'UnconnectedColorArrayPicker';\n\nexport default connectToContainer(UnconnectedColorArrayPicker);\n"],"file":"ColorArrayPicker.js"}